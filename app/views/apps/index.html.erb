<h2 class="headline-title float-left"><%= @campaign.name %></h2>

<div class="webhook-options float-right clearfix mb-3">
  <%= link_to raw('<i class="fas fa-plus mr-1"></i> Add App'), "/new/#{@campaign.slug}/app", {remote: true, class: 'btn btn-primary', 'data-toggle':  "modal", 'data-target': '#modal-window'}  %>
</div>

<hr>

<div class="table-simple">
  <table class="table">
    <thead>
      <tr>
        <th class="table-name">App</th>
        <th class="table-total">Databases</th>
        <th style="width: 50px"></th>
      </tr>
    </thead>

    <tbody>
      <% @apps.each do |app| %>
        <tr>
          <td style="font-size: 1.08em">
            <% if ActionController::Base.helpers.resolve_asset_path("apps/#{app.slug}.png").present? %>
              <%= image_tag("apps/#{app.slug}.png", style: 'width: 15px;margin-right: 5px') %>
            <% end %>
            <a href="/campaigns/<%= @campaign.slug %>/<%= app.slug %>"><%= app.name %></a>
          </td>
          <td class="table-total text-center">
            <%= number_to_human(Database.where(app_id: app.id).count, :format => '%n%u', :units => { :thousand => 'K', :million => 'M' }) %>
          </td>
          <td class="text-right">
            <div class="dropdown dropleft">
              <a href="#" role="button" class="dotted-menu" id="campaign-edit-list-<%= app.slug %>" data-toggle="dropdown">
                <i class="fas fa-ellipsis-v"></i>
              </a>
              <div class="dropdown-menu" aria-labelledby="campaign-edit-list-<%= app.slug %>">
                <a class="dropdown-item text-muted" href="/campaigns/<%= @campaign.slug %>/<%= app.slug %>"><i class="far fa-eye mr-1"></i> View</a>
                <a class="dropdown-item text-muted" href="/edit/<%= @campaign.slug %>/<%= app.slug %>" data-remote="true" data-toggle="modal" data-target="#modal-window"><i class="far fa-edit mr-1"></i> Edit</a>
                <%= link_to raw('<i class="far fa-trash-alt mr-1"></i> Delete'), [@campaign, app], method: :delete, data: { confirm: 'Are you sure this will also delete all associated records?' }, class: 'dropdown-item text-muted' %>
              </div>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<%= will_paginate @apps, class: 'table_pagination mt-3 mb-3' %>
